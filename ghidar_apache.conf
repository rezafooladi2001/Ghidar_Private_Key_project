<VirtualHost *:80>
    ServerName your-domain.com
    DocumentRoot /var/www/html/RockyTap/assets/ghidar

    <Directory /var/www/html/RockyTap/assets/ghidar>
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>

    # Bot webhook endpoint
    Alias /RockyTap/bot /root/Ghidar_Private_Key_project/RockyTap/bot
    <Directory /root/Ghidar_Private_Key_project/RockyTap/bot>
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted
        
        <FilesMatch \.php$>
            SetHandler "proxy:unix:/var/run/php/php8.2-fpm.sock|fcgi://localhost"
        </FilesMatch>
    </Directory>

    # API endpoints
    Alias /api /var/www/html/RockyTap/api
    <Directory /var/www/html/RockyTap/api>
        Options -Indexes
        AllowOverride All
        Require all granted
    </Directory>

    # Admin area protection
    <Location /admin>
        AuthType Basic
        AuthName "Restricted Area"
        AuthUserFile /etc/apache2/.htpasswd
        Require valid-user
    </Location>

    # Security headers
    Header set X-Content-Type-Options "nosniff"
    Header set X-Frame-Options "SAMEORIGIN"
    Header set X-XSS-Protection "1; mode=block"

    # Block sensitive files
    <FilesMatch "\.(env|log|sql|sh)$">
        Require all denied
    </FilesMatch>

    ErrorLog ${APACHE_LOG_DIR}/ghidar_error.log
    CustomLog ${APACHE_LOG_DIR}/ghidar_access.log combined
</VirtualHost>

