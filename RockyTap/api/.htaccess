RewriteEngine On
RewriteBase /RockyTap/api/

# Disable directory slash redirect for API endpoints
DirectorySlash Off

# Allow OPTIONS for CORS preflight
RewriteCond %{REQUEST_METHOD} OPTIONS
RewriteRule ^(.*)$ $1 [R=200,L]

# Route requests to index.php in subdirectories (with or without trailing slash)
# First check if it's a directory and route to index.php
RewriteCond %{REQUEST_FILENAME} -d
RewriteCond %{REQUEST_URI} !/$
RewriteRule ^(.*)$ $1/index.php [L]

# If not a file or directory, route to index.php in subdirectory
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-l
RewriteCond %{REQUEST_URI} !\.php$
RewriteRule ^([^/]+)/?$ $1/index.php [L]

