import{r as o,j as e,u as D,g as I,a as k,T as L,b as C,A as B,L as E,c as $,R as G,G as R,C as V}from"./index.js";import{C as v,a as T,g as A,b as H,E as z,P as M}from"./PullToRefresh.js";import{W as P}from"./WalletSummary.js";const F="_container_1xpen_1",U="_content_1xpen_5",W="_stat_1xpen_14",K="_statValue_1xpen_23",O="_statLabel_1xpen_31",Y="_divider_1xpen_38",q="_updateIndicator_1xpen_45",J="_updateDot_1xpen_54",Q="_statSkeleton_1xpen_72",X="_labelSkeleton_1xpen_80",s={container:F,content:U,stat:W,statValue:K,statLabel:O,divider:Y,updateIndicator:q,updateDot:J,statSkeleton:Q,labelSkeleton:X};function S(a){return a>=1e6?`${(a/1e6).toFixed(1)}M+`:a>=1e3?`${(a/1e3).toFixed(1)}K+`:a.toLocaleString()}function Z({autoRefresh:a=!0,refreshInterval:n=3e4,className:u=""}){const[r,p]=o.useState(null),[x,h]=o.useState(!0),[N,_]=o.useState(null),[g,c]=o.useState(null),m=async()=>{try{_(null);const d=await A();p(d),c(new Date)}catch(d){const j=H(d);_(j),console.warn("Failed to load statistics:",j)}finally{h(!1)}};return o.useEffect(()=>{if(m(),a){const d=setInterval(m,n);return()=>clearInterval(d)}},[a,n]),x&&!r?e.jsx(v,{className:`${s.container} ${u}`,children:e.jsxs(T,{className:s.content,children:[e.jsxs("div",{className:s.stat,children:[e.jsx("div",{className:s.statSkeleton}),e.jsx("div",{className:s.labelSkeleton})]}),e.jsxs("div",{className:s.stat,children:[e.jsx("div",{className:s.statSkeleton}),e.jsx("div",{className:s.labelSkeleton})]}),e.jsxs("div",{className:s.stat,children:[e.jsx("div",{className:s.statSkeleton}),e.jsx("div",{className:s.labelSkeleton})]})]})}):r?e.jsx(v,{className:`${s.container} ${u}`,children:e.jsxs(T,{className:s.content,children:[e.jsxs("div",{className:s.stat,children:[e.jsx("span",{className:s.statValue,children:S(r.total_players)}),e.jsx("span",{className:s.statLabel,children:"Total Users"})]}),e.jsx("div",{className:s.divider,"aria-hidden":"true"}),e.jsxs("div",{className:s.stat,children:[e.jsx("span",{className:s.statValue,children:S(r.online)}),e.jsx("span",{className:s.statLabel,children:"Online Now"})]}),e.jsx("div",{className:s.divider,"aria-hidden":"true"}),e.jsxs("div",{className:s.stat,children:[e.jsx("span",{className:s.statValue,children:S(r.daily)}),e.jsx("span",{className:s.statLabel,children:"New Today"})]}),g&&e.jsx("div",{className:s.updateIndicator,"aria-label":`Last updated: ${g.toLocaleTimeString()}`,children:e.jsx("span",{className:s.updateDot})})]})}):null}const ee="_container_tp0b0_1",te="_hero_tp0b0_15",se="_heroBackground_tp0b0_21",ae="_heroContent_tp0b0_30",ne="_greeting_tp0b0_35",re="_greetingText_tp0b0_39",oe="_userName_tp0b0_46",ie="_tagline_tp0b0_63",ce="_premiumBadge_tp0b0_70",le="_premiumIcon_tp0b0_85",de="_walletSection_tp0b0_90",ue="_features_tp0b0_96",pe="_sectionTitle_tp0b0_100",_e="_featureGrid_tp0b0_108",me="_featureCard_tp0b0_114",xe="_featureContent_tp0b0_123",he="_featureIcon_tp0b0_130",ge="_featureInfo_tp0b0_142",je="_featureTitleRow_tp0b0_147",fe="_featureTitle_tp0b0_147",be="_featureBadge_tp0b0_162",Ne="_featureDescription_tp0b0_173",Se="_featureArrow_tp0b0_180",ve="_trustSection_tp0b0_192",Te="_telegramBranding_tp0b0_197",ye="_statsSection_tp0b0_205",we="_userStatsSection_tp0b0_210",De="_statsGrid_tp0b0_215",Ie="_stat_tp0b0_205",ke="_statValue_tp0b0_232",Le="_statLabel_tp0b0_239",Ce="_statDivider_tp0b0_247",t={container:ee,hero:te,heroBackground:se,heroContent:ae,greeting:ne,greetingText:re,userName:oe,tagline:ie,premiumBadge:ce,premiumIcon:le,walletSection:de,features:ue,sectionTitle:pe,featureGrid:_e,featureCard:me,featureContent:xe,featureIcon:he,featureInfo:ge,featureTitleRow:je,featureTitle:fe,featureBadge:be,featureDescription:Ne,featureArrow:Se,trustSection:ve,telegramBranding:Te,statsSection:ye,userStatsSection:we,statsGrid:De,stat:Ie,statValue:ke,statLabel:Le,statDivider:Ce};function b({icon:a,title:n,description:u,badge:r,onClick:p,delay:x=0}){return e.jsx(v,{variant:"elevated",className:t.featureCard,onClick:p,padding:"none",children:e.jsxs(T,{className:t.featureContent,children:[e.jsx("div",{className:t.featureIcon,children:a}),e.jsxs("div",{className:t.featureInfo,children:[e.jsxs("div",{className:t.featureTitleRow,children:[e.jsx("h3",{className:t.featureTitle,children:n}),r&&e.jsx("span",{className:t.featureBadge,children:r})]}),e.jsx("p",{className:t.featureDescription,children:u})]}),e.jsx("div",{className:t.featureArrow,children:e.jsx(V,{size:20})})]})})}function Be({message:a}){return e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",minHeight:"300px",padding:"20px"},children:[e.jsx(R,{size:"lg",animate:!0}),e.jsx("p",{style:{color:"#94a3b8",marginTop:"20px"},children:a})]})}function Re({onNavigate:a}){const[n,u]=o.useState(null),[r,p]=o.useState(!0),[x,h]=o.useState(null),[N,_]=o.useState(""),{showError:g}=D(),c=I();o.useEffect(()=>{m()},[]);const m=async()=>{var j,y;console.log("[HomeScreen] loadData called");try{p(!0),h(null),_("");const i=k();console.log("[HomeScreen] initData length:",(i==null?void 0:i.length)||0);const l=await fetch("/RockyTap/api/me/",{method:"GET",headers:{"Content-Type":"application/json","Telegram-Data":i||""}});console.log("[HomeScreen] /me/ response status:",l.status);const f=await l.json();if(console.log("[HomeScreen] /me/ response:",f),!l.ok||!f.success){const w=((j=f.error)==null?void 0:j.message)||`HTTP ${l.status}`;h(w),_(`Status: ${l.status}, Code: ${((y=f.error)==null?void 0:y.code)||"UNKNOWN"}`),g(w);return}u(f.data)}catch(i){console.error("[HomeScreen] loadData error:",i);const l=i instanceof Error?i.message:"Network error";h(l),_(String(i)),g(l)}finally{p(!1)}};if(r)return e.jsx(Be,{message:"Loading your wallet..."});if(x)return e.jsxs("div",{style:{padding:"20px"},children:[e.jsx(z,{message:x,onRetry:m}),N&&e.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#1e293b",borderRadius:"8px",fontSize:"12px",color:"#94a3b8"},children:[e.jsx("strong",{children:"Debug Info:"}),e.jsx("br",{}),N]})]});const d=(c==null?void 0:c.first_name)||(n==null?void 0:n.user.first_name)||"User";return e.jsx(M,{onRefresh:m,children:e.jsxs("div",{className:t.container,children:[e.jsxs("section",{className:t.hero,children:[e.jsx("div",{className:t.heroBackground}),e.jsxs("div",{className:t.heroContent,children:[e.jsxs("div",{className:t.greeting,children:[e.jsx("span",{className:t.greetingText,children:"Welcome back,"}),e.jsx("h1",{className:t.userName,children:d})]}),e.jsx("p",{className:t.tagline,children:"Your secure gateway to crypto opportunities"}),e.jsx("div",{className:t.telegramBranding,children:e.jsx(L,{variant:"text"})}),(c==null?void 0:c.is_premium)&&e.jsxs("div",{className:t.premiumBadge,children:[e.jsx("span",{className:t.premiumIcon,children:"â­"}),e.jsx("span",{children:"Premium Member"})]})]})]}),e.jsx("section",{className:t.trustSection,children:e.jsx(C,{variant:"compact",showLabels:!0})}),n&&e.jsx("section",{className:t.walletSection,children:e.jsx(P,{usdtBalance:n.wallet.usdt_balance,ghdBalance:n.wallet.ghd_balance})}),e.jsxs("section",{className:t.features,children:[e.jsx("h2",{className:t.sectionTitle,children:"Explore Features"}),e.jsxs("div",{className:t.featureGrid,children:[e.jsx(b,{icon:e.jsx(B,{size:24,color:"var(--brand-primary)"}),title:"GHD Airdrop",description:"Mine GHD tokens by tapping and convert to USDT",badge:"Popular",onClick:()=>a("airdrop")}),e.jsx(b,{icon:e.jsx(E,{size:24,color:"var(--brand-gold)"}),title:"Lottery",description:"Buy tickets and win big prizes in our draws",onClick:()=>a("lottery")}),e.jsx(b,{icon:e.jsx($,{size:24,color:"var(--info)"}),title:"AI Trader",description:"Let our AI trade for you and earn passive income",badge:"Pro",onClick:()=>a("trader")}),e.jsx(b,{icon:e.jsx(G,{size:24,color:"var(--success)"}),title:"Referral Program",description:"Invite friends and earn USDT commissions",onClick:()=>a("referral")})]})]}),e.jsx("section",{className:t.statsSection,children:e.jsx(Z,{})}),e.jsx("section",{className:t.userStatsSection,children:e.jsxs("div",{className:t.statsGrid,children:[e.jsxs("div",{className:t.stat,children:[e.jsx("span",{className:t.statValue,children:n!=null&&n.user.joining_date?new Date(n.user.joining_date*1e3).toLocaleDateString(void 0,{month:"short",year:"numeric"}):"Today"}),e.jsx("span",{className:t.statLabel,children:"Member Since"})]}),e.jsx("div",{className:t.statDivider}),e.jsxs("div",{className:t.stat,children:[e.jsx("span",{className:t.statValue,children:"Level 1"}),e.jsx("span",{className:t.statLabel,children:"Account Tier"})]})]})})]})})}export{Re as HomeScreen};
