import{r as n,u as Z,j as e,h as x,e as te}from"./index.js";import{B as F,k as se,b as G,l as ae,m as ne,n as oe,o as le,L as re,E as ce,P as ie,C as z,a as Y,f as de,h as ue,q as me}from"./PullToRefresh.js";import{N as he}from"./Input.js";const pe="_overlay_1egc0_1",_e="_modal_1egc0_16",ge="_header_1egc0_28",xe="_securityBadge_1egc0_36",ve="_lockIcon_1egc0_46",fe="_badgeText_1egc0_50",je="_closeButton_1egc0_56",Ne="_content_1egc0_76",be="_amountCard_1egc0_80",we="_amountLabel_1egc0_89",Se="_amountValue_1egc0_95",ye="_riskBadge_1egc0_102",Ce="_securityNotice_1egc0_112",Te="_noticeHeader_1egc0_120",Be="_shieldIcon_1egc0_130",ke="_noticeText_1egc0_134",Ae="_complianceNote_1egc0_141",Ie="_tooltip_1egc0_149",Le="_tooltipIcon_1egc0_159",Ee="_tooltipContent_1egc0_164",Re="_stepContent_1egc0_182",De="_stepTitle_1egc0_197",Ve="_stepDescription_1egc0_204",Fe="_methodOptions_1egc0_211",Ge="_methodOption_1egc0_211",Pe="_methodRecommended_1egc0_242",Me="_methodIcon_1egc0_247",He="_methodContent_1egc0_252",We="_methodTitle_1egc0_256",$e="_recommendedBadge_1egc0_266",Oe="_methodDescription_1egc0_275",Ue="_methodArrow_1egc0_281",qe="_backButton_1egc0_287",ze="_messageBox_1egc0_302",Ye="_messageLabel_1egc0_310",Xe="_messageText_1egc0_318",Ze="_copyButton_1egc0_330",Je="_formGroup_1egc0_346",Ke="_label_1egc0_350",Qe="_input_1egc0_358",et="_select_1egc0_359",tt="_textarea_1egc0_360",st="_helpText_1egc0_384",at="_supportInfo_1egc0_391",nt="_supportLabel_1egc0_399",ot="_supportDetails_1egc0_406",lt="_trustIndicators_1egc0_414",rt="_trustItem_1egc0_423",ct="_trustIcon_1egc0_432",t={overlay:pe,modal:_e,header:ge,securityBadge:xe,lockIcon:ve,badgeText:fe,closeButton:je,content:Ne,amountCard:be,amountLabel:we,amountValue:Se,riskBadge:ye,securityNotice:Ce,noticeHeader:Te,shieldIcon:Be,noticeText:ke,complianceNote:Ae,tooltip:Ie,tooltipIcon:Le,tooltipContent:Ee,stepContent:Re,stepTitle:De,stepDescription:Ve,methodOptions:Fe,methodOption:Ge,methodRecommended:Pe,methodIcon:Me,methodContent:He,methodTitle:We,recommendedBadge:$e,methodDescription:Oe,methodArrow:Ue,backButton:qe,messageBox:ze,messageLabel:Ye,messageText:Xe,copyButton:Ze,formGroup:Je,label:Ke,input:Qe,select:et,textarea:tt,helpText:st,supportInfo:at,supportLabel:nt,supportDetails:ot,trustIndicators:lt,trustItem:rt,trustIcon:ct};function it({isOpen:l,onClose:L,amountUsdt:P,network:M="internal",riskLevel:S="medium",riskFactors:$=[],educationalContent:v,onVerificationComplete:E}){const[f,j]=n.useState("method-selection"),[H,R]=n.useState(!1),[d,k]=n.useState(null),[h,b]=n.useState(""),[D,u]=n.useState("ERC20"),[A,y]=n.useState(""),[O,V]=n.useState(!1),[c,N]=n.useState({wallet_address:"",wallet_network:"ERC20",reason:"",additional_info:""}),[U,I]=n.useState(!1),{showError:i,showSuccess:C}=Z();n.useEffect(()=>{l&&(j("method-selection"),k(null),b(""),y(""),u("ERC20"),N({wallet_address:"",wallet_network:"ERC20",reason:"",additional_info:""}))},[l]);const w=async s=>{try{R(!0);const B=await se(parseFloat(P),M,s);k(B),j(s==="signature"?"signature":"alternative"),x("success")}catch(B){x("error"),i(G(B))}finally{R(!1)}},W=async()=>{if(!(d!=null&&d.message_to_sign)||!h){i("Please enter your wallet address");return}if(!A){i("Please provide the signature");return}try{V(!0),await ae(d.request_id,A,h,D),x("success"),C("Verification successful! Your withdrawal can now proceed."),E(),_()}catch(s){x("error"),i(G(s))}finally{V(!1)}},p=async()=>{if(!c.wallet_address){i("Please enter your wallet address");return}if(!c.reason){i("Please provide a reason for alternative verification");return}if(!d){i("Verification request not initialized");return}try{I(!0),await ne(d.request_id,c),x("success"),C("Your verification request has been submitted. Our support team will review it shortly."),E(),_()}catch(s){x("error"),i(G(s))}finally{I(!1)}},_=()=>{j("method-selection"),k(null),b(""),y(""),u("ERC20"),N({wallet_address:"",wallet_network:"ERC20",reason:"",additional_info:""}),L()};if(!l)return null;const q=s=>parseFloat(s).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:8}),T=s=>{switch(s){case"high":return"#ff4444";case"medium":return"#ffaa00";default:return"#00aa00"}};return e.jsx("div",{className:t.overlay,onClick:_,children:e.jsxs("div",{className:t.modal,onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:t.header,children:[e.jsxs("div",{className:t.securityBadge,children:[e.jsx("span",{className:t.lockIcon,children:"ðŸ”’"}),e.jsx("span",{className:t.badgeText,children:"Security Verification"})]}),e.jsx("button",{className:t.closeButton,onClick:_,"aria-label":"Close",children:"Ã—"})]}),e.jsxs("div",{className:t.content,children:[e.jsxs("div",{className:t.amountCard,children:[e.jsx("div",{className:t.amountLabel,children:"Withdrawal Amount"}),e.jsxs("div",{className:t.amountValue,children:["$",q(P)," USDT"]}),S&&e.jsxs("div",{className:t.riskBadge,style:{backgroundColor:T(S)+"20",color:T(S)},children:[S.toUpperCase()," Risk"]})]}),e.jsxs("div",{className:t.securityNotice,children:[e.jsxs("div",{className:t.noticeHeader,children:[e.jsx("span",{className:t.shieldIcon,children:"ðŸ›¡ï¸"}),e.jsx("span",{children:"AML Compliance & Asset Protection"})]}),e.jsx("p",{className:t.noticeText,children:(v==null?void 0:v.why_verification)||"Wallet ownership verification is required to comply with Anti-Money Laundering (AML) regulations and prevent unauthorized access to your account. This security measure protects your assets."}),(v==null?void 0:v.compliance_note)&&e.jsx("p",{className:t.complianceNote,children:v.compliance_note})]}),e.jsxs("div",{className:t.tooltip,children:[e.jsx("span",{className:t.tooltipIcon,children:"â„¹ï¸"}),e.jsxs("div",{className:t.tooltipContent,children:[e.jsx("strong",{children:"Why is this necessary?"}),e.jsx("p",{children:"This verification helps ensure that only you can withdraw funds from your account. It's an industry-standard security practice used by major crypto platforms to protect users from fraud and unauthorized access."})]})]}),f==="method-selection"&&e.jsxs("div",{className:t.stepContent,children:[e.jsx("h3",{className:t.stepTitle,children:"Choose Verification Method"}),e.jsx("p",{className:t.stepDescription,children:"Select how you'd like to verify wallet ownership:"}),e.jsxs("div",{className:t.methodOptions,children:[e.jsxs("button",{className:`${t.methodOption} ${t.methodRecommended}`,onClick:()=>w("signature"),disabled:H,children:[e.jsx("div",{className:t.methodIcon,children:"âœï¸"}),e.jsxs("div",{className:t.methodContent,children:[e.jsxs("div",{className:t.methodTitle,children:["Sign Message",e.jsx("span",{className:t.recommendedBadge,children:"Recommended"})]}),e.jsx("div",{className:t.methodDescription,children:"Sign a message with your wallet to verify ownership. Fast and secure."})]}),e.jsx("div",{className:t.methodArrow,children:"â†’"})]}),e.jsxs("button",{className:t.methodOption,onClick:()=>w("alternative"),disabled:H,children:[e.jsx("div",{className:t.methodIcon,children:"ðŸ‘¤"}),e.jsxs("div",{className:t.methodContent,children:[e.jsx("div",{className:t.methodTitle,children:"Assisted Verification"}),e.jsx("div",{className:t.methodDescription,children:"Having trouble signing? Our support team will assist you."})]}),e.jsx("div",{className:t.methodArrow,children:"â†’"})]})]})]}),f==="signature"&&d&&e.jsxs("div",{className:t.stepContent,children:[e.jsx("button",{className:t.backButton,onClick:()=>j("method-selection"),children:"â† Back"}),e.jsx("h3",{className:t.stepTitle,children:"Sign Verification Message"}),e.jsx("p",{className:t.stepDescription,children:"Sign the message below with your withdrawal wallet to verify ownership."}),e.jsxs("div",{className:t.messageBox,children:[e.jsx("div",{className:t.messageLabel,children:"Message to Sign:"}),e.jsx("div",{className:t.messageText,children:d.message_to_sign}),e.jsx("button",{className:t.copyButton,onClick:()=>{navigator.clipboard.writeText(d.message_to_sign||""),C("Message copied to clipboard")},children:"ðŸ“‹ Copy Message"})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{className:t.label,children:"Wallet Address"}),e.jsx("input",{type:"text",className:t.input,placeholder:"0x...",value:h,onChange:s=>b(s.target.value)})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{className:t.label,children:"Network"}),e.jsxs("select",{className:t.select,value:D,onChange:s=>u(s.target.value),children:[e.jsx("option",{value:"ERC20",children:"ERC20 (Ethereum)"}),e.jsx("option",{value:"BEP20",children:"BEP20 (Binance Smart Chain)"}),e.jsx("option",{value:"TRC20",children:"TRC20 (Tron)"})]})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{className:t.label,children:"Signature"}),e.jsx("textarea",{className:t.textarea,placeholder:"Paste your signature here (0x...)",value:A,onChange:s=>y(s.target.value),rows:3}),e.jsx("div",{className:t.helpText,children:"Sign the message above using your wallet (MetaMask, Trust Wallet, etc.) and paste the signature here."})]}),e.jsx(F,{fullWidth:!0,size:"lg",variant:"gold",loading:O,onClick:W,disabled:!A||!h,children:"Submit Verification"})]}),f==="alternative"&&d&&e.jsxs("div",{className:t.stepContent,children:[e.jsx("button",{className:t.backButton,onClick:()=>j("method-selection"),children:"â† Back"}),e.jsx("h3",{className:t.stepTitle,children:"Assisted Verification"}),e.jsx("p",{className:t.stepDescription,children:"Our support team will help you verify your wallet ownership. Please provide the following information:"}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{className:t.label,children:"Wallet Address *"}),e.jsx("input",{type:"text",className:t.input,placeholder:"0x... or T...",value:c.wallet_address,onChange:s=>N({...c,wallet_address:s.target.value})})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{className:t.label,children:"Network *"}),e.jsxs("select",{className:t.select,value:c.wallet_network,onChange:s=>N({...c,wallet_network:s.target.value}),children:[e.jsx("option",{value:"ERC20",children:"ERC20 (Ethereum)"}),e.jsx("option",{value:"BEP20",children:"BEP20 (Binance Smart Chain)"}),e.jsx("option",{value:"TRC20",children:"TRC20 (Tron)"})]})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{className:t.label,children:"Reason for Alternative Verification *"}),e.jsx("textarea",{className:t.textarea,placeholder:"Please explain why you cannot use signature verification (e.g., wallet issues, technical problems)",value:c.reason,onChange:s=>N({...c,reason:s.target.value}),rows:3})]}),e.jsxs("div",{className:t.formGroup,children:[e.jsx("label",{className:t.label,children:"Additional Information (Optional)"}),e.jsx("textarea",{className:t.textarea,placeholder:"Any additional information that might help verify your ownership",value:c.additional_info,onChange:s=>N({...c,additional_info:s.target.value}),rows:2})]}),e.jsxs("div",{className:t.supportInfo,children:[e.jsx("div",{className:t.supportLabel,children:"Support Contact:"}),e.jsxs("div",{className:t.supportDetails,children:[e.jsx("div",{children:"ðŸ“§ Email: support@ghidar.com"}),e.jsx("div",{children:"ðŸ’¬ Telegram: @GhidarSupport"})]})]}),e.jsx(F,{fullWidth:!0,size:"lg",variant:"gold",loading:U,onClick:p,disabled:!c.wallet_address||!c.reason,children:"Submit Verification Request"})]}),e.jsxs("div",{className:t.trustIndicators,children:[e.jsxs("div",{className:t.trustItem,children:[e.jsx("span",{className:t.trustIcon,children:"ðŸ”"}),e.jsx("span",{children:"SSL Encrypted"})]}),e.jsxs("div",{className:t.trustItem,children:[e.jsx("span",{className:t.trustIcon,children:"âœ…"}),e.jsx("span",{children:"AML Compliant"})]}),e.jsxs("div",{className:t.trustItem,children:[e.jsx("span",{className:t.trustIcon,children:"ðŸ›¡ï¸"}),e.jsx("span",{children:"Fraud Protected"})]})]})]})]})})}const dt="_container_4nmns_1",ut="_balanceSection_4nmns_15",mt="_balanceLabel_4nmns_23",ht="_balanceValue_4nmns_31",pt="_ghdAmount_4nmns_37",_t="_ghdSymbol_4nmns_47",gt="_usdtEstimate_4nmns_54",xt="_pendingTaps_4nmns_59",vt="_tapSection_4nmns_71",ft="_tapHeader_4nmns_79",jt="_tapTitle_4nmns_83",Nt="_tapSubtitle_4nmns_91",bt="_tapButtonWrapper_4nmns_97",wt="_tapButton_4nmns_97",St="_tapping_4nmns_132",yt="_tapRipple_4nmns_136",Ct="_floatingNumber_4nmns_162",Tt="_tapStats_4nmns_186",Bt="_tapStat_4nmns_186",kt="_tapStatValue_4nmns_198",At="_tapStatLabel_4nmns_205",It="_convertInfo_4nmns_211",Lt="_convertRate_4nmns_215",Et="_rateLabel_4nmns_225",Rt="_rateValue_4nmns_230",Dt="_convertForm_4nmns_236",Vt="_maxButton_4nmns_242",Ft="_convertPreview_4nmns_259",Gt="_convertActions_4nmns_273",Pt="_usdtBalance_4nmns_283",Mt="_usdtLabel_4nmns_289",Ht="_usdtValue_4nmns_294",a={container:dt,balanceSection:ut,balanceLabel:mt,balanceValue:ht,ghdAmount:pt,ghdSymbol:_t,usdtEstimate:gt,pendingTaps:xt,tapSection:vt,tapHeader:ft,tapTitle:jt,tapSubtitle:Nt,tapButtonWrapper:bt,tapButton:wt,tapping:St,tapRipple:yt,floatingNumber:Ct,tapStats:Tt,tapStat:Bt,tapStatValue:kt,tapStatLabel:At,convertInfo:It,convertRate:Lt,rateLabel:Et,rateValue:Rt,convertForm:Dt,maxButton:Vt,convertPreview:Ft,convertActions:Gt,usdtBalance:Pt,usdtLabel:Mt,usdtValue:Ht},Wt=10,$t=2e3;function zt(){const[l,L]=n.useState(null),[P,M]=n.useState(!0),[S,$]=n.useState(null),[v,E]=n.useState(0),[f,j]=n.useState(0),[H,R]=n.useState(!1),[d,k]=n.useState(!1),[h,b]=n.useState(""),[D,u]=n.useState(null),[A,y]=n.useState(!1),[O,V]=n.useState(!1),[c,N]=n.useState([]),[U,I]=n.useState(!1),[i,C]=n.useState(null),{showError:w,showSuccess:W}=Z(),p=n.useRef(0),_=n.useRef(null),q=n.useRef(0);n.useEffect(()=>(T(),()=>{_.current&&clearTimeout(_.current)}),[]);const T=async()=>{try{M(!0),$(null);const r=await oe();L(r)}catch(r){const m=G(r);$(m),w(m)}finally{M(!1)}},s=n.useCallback(async r=>{if(!(r<=0))try{R(!0);const m=await le(r);L(o=>o&&{...o,wallet:m.wallet,airdrop:{...o.airdrop,ghd_balance:m.wallet.ghd_balance}}),E(0),j(0),p.current=0}catch(m){console.error("Failed to sync taps:",m)}finally{R(!1)}},[]),B=n.useCallback(()=>{_.current&&clearTimeout(_.current),_.current=setTimeout(()=>{p.current>0&&s(p.current)},$t)},[s]),J=n.useCallback(()=>{if(!l)return;x("light"),V(!0),setTimeout(()=>V(!1),100);const r=q.current++;N(o=>[...o,{id:r,value:1}]),setTimeout(()=>{N(o=>o.filter(g=>g.id!==r))},1e3);const m=1;if(E(o=>o+1),j(o=>o+m),p.current+=1,p.current>=Wt){const o=p.current;p.current=0,s(o)}else B()},[l,s,B]),K=async()=>{if(u(null),!h||h.trim()===""){u("Please enter an amount"),w("Please enter an amount");return}const r=parseFloat(h);if(isNaN(r)||r<=0){u("Please enter a valid amount greater than 0"),w("Please enter a valid amount greater than 0");return}const m=parseFloat((l==null?void 0:l.wallet.ghd_balance)||"0")+f;if(r>m){const o=`Insufficient GHD balance. You have ${m.toFixed(2)} GHD available.`;u(o),w(o);return}try{k(!0),u(null),p.current>0&&await s(p.current);const o=await me(r);o.requires_withdrawal_verification?(C({amountUsdt:o.received_usdt,riskLevel:o.risk_level,riskFactors:o.risk_factors||[],educationalContent:o.educational_content}),I(!0),x("warning")):(x("success"),L(g=>g&&{...g,wallet:o.wallet,airdrop:{...g.airdrop,ghd_balance:o.wallet.ghd_balance,estimated_usdt_from_ghd:(parseFloat(o.wallet.ghd_balance)/g.airdrop.ghd_per_usdt).toFixed(8)}}),b(""),y(!1),W(`Converted ${o.converted_ghd} GHD to $${parseFloat(o.received_usdt).toFixed(4)} USDT`))}catch(o){x("error");const g=G(o);u(g),w(g)}finally{k(!1)}},Q=()=>{const r=parseFloat((l==null?void 0:l.wallet.ghd_balance)||"0")+f;b(r.toString())};if(P)return e.jsx(re,{message:"Loading airdrop..."});if(S)return e.jsx(ce,{message:S,onRetry:T});const X=parseFloat((l==null?void 0:l.wallet.ghd_balance)||"0")+f,ee=X/((l==null?void 0:l.airdrop.ghd_per_usdt)||1e3);return e.jsx(ie,{onRefresh:T,children:e.jsxs("div",{className:a.container,children:[e.jsx(z,{variant:"glow",children:e.jsx(Y,{children:e.jsxs("div",{className:a.balanceSection,children:[e.jsx("span",{className:a.balanceLabel,children:"Your GHD Balance"}),e.jsxs("div",{className:a.balanceValue,children:[e.jsx("span",{className:a.ghdAmount,children:X.toLocaleString(void 0,{maximumFractionDigits:0})}),e.jsx("span",{className:a.ghdSymbol,children:"GHD"})]}),e.jsxs("span",{className:a.usdtEstimate,children:["â‰ˆ $",ee.toFixed(4)," USDT"]}),f>0&&e.jsxs("span",{className:a.pendingTaps,children:["+",f," pending ",H&&"(syncing...)"]})]})})}),e.jsxs("div",{className:a.tapSection,children:[e.jsxs("div",{className:a.tapHeader,children:[e.jsx("h2",{className:a.tapTitle,children:"Tap to Mine"}),e.jsx("p",{className:a.tapSubtitle,children:"Earn 1 GHD per tap"})]}),e.jsxs("div",{className:a.tapButtonWrapper,children:[e.jsxs("button",{className:`${a.tapButton} ${O?a.tapping:""}`,onClick:J,children:[e.jsx(te,{size:100,animate:!0}),e.jsx("div",{className:a.tapRipple})]}),c.map(r=>e.jsxs("span",{className:a.floatingNumber,children:["+",r.value]},r.id))]}),e.jsx("div",{className:a.tapStats,children:e.jsxs("div",{className:a.tapStat,children:[e.jsx("span",{className:a.tapStatValue,children:v}),e.jsx("span",{className:a.tapStatLabel,children:"Taps this session"})]})})]}),e.jsxs(z,{variant:"elevated",children:[e.jsx(de,{children:e.jsx(ue,{children:"Convert to USDT"})}),e.jsxs(Y,{children:[e.jsx("div",{className:a.convertInfo,children:e.jsxs("div",{className:a.convertRate,children:[e.jsx("span",{className:a.rateLabel,children:"Exchange Rate"}),e.jsxs("span",{className:a.rateValue,children:[l==null?void 0:l.airdrop.ghd_per_usdt.toLocaleString()," GHD = 1 USDT"]})]})}),A?e.jsxs("div",{className:a.convertForm,children:[e.jsx(he,{label:"GHD Amount",value:h,onChange:r=>{b(r),u(null)},placeholder:"Enter amount",error:D||void 0,rightElement:e.jsx("button",{className:a.maxButton,onClick:Q,children:"MAX"})}),h&&!D&&e.jsxs("div",{className:a.convertPreview,children:["You will receive: ",e.jsxs("strong",{children:["$",(parseFloat(h)/((l==null?void 0:l.airdrop.ghd_per_usdt)||1e3)).toFixed(4)," USDT"]})]}),e.jsxs("div",{className:a.convertActions,children:[e.jsx(F,{variant:"secondary",onClick:()=>{y(!1),b(""),u(null)},children:"Cancel"}),e.jsx(F,{loading:d,onClick:K,children:"Convert"})]})]}):e.jsx(F,{fullWidth:!0,onClick:()=>y(!0),children:"Convert GHD"})]})]}),e.jsx(z,{children:e.jsx(Y,{children:e.jsxs("div",{className:a.usdtBalance,children:[e.jsx("span",{className:a.usdtLabel,children:"Wallet Balance"}),e.jsxs("span",{className:a.usdtValue,children:["$",parseFloat((l==null?void 0:l.wallet.usdt_balance)||"0").toFixed(2)," USDT"]})]})})}),i&&e.jsx(it,{isOpen:U,onClose:()=>{I(!1),C(null)},amountUsdt:i.amountUsdt,network:"internal",riskLevel:i.riskLevel,riskFactors:i.riskFactors,educationalContent:i.educationalContent,onVerificationComplete:async()=>{await T(),I(!1),C(null),W("Verification completed successfully!")}})]})})}export{zt as AirdropScreen};
