import{r as l,u as V,E as W,F as k,j as a,C as f,o as v,p as y,e as H,a as g,I as A,J as I,B as h,K as z,h as w,M as Y}from"./index.js";import{N as J}from"./Input.js";import{g as L,L as K,E as X,P as q}from"./PullToRefresh.js";import{E as G}from"./EmptyState.js";import{W as O}from"./WalletSummary.js";const Q="_container_axu0a_1",Z="_aiSummary_axu0a_15",aa="_mainBalance_axu0a_21",ea="_mainLabel_axu0a_29",ta="_mainValue_axu0a_39",sa="_statsRow_axu0a_49",na="_statItem_axu0a_54",ra="_statLabel_axu0a_62",ia="_statValue_axu0a_67",oa="_positive_axu0a_74",la="_negative_axu0a_78",ca="_statDivider_axu0a_82",da="_performanceBar_axu0a_88",ua="_performanceFill_axu0a_95",ma="_actionForm_axu0a_110",_a="_actionHeader_axu0a_116",ha="_actionTitle_axu0a_122",xa="_actionButtons_axu0a_129",pa="_maxButton_axu0a_138",ja="_historyList_axu0a_156",fa="_historyItem_axu0a_162",va="_historyDate_axu0a_171",ya="_historyBalance_axu0a_177",ga="_historyPnl_axu0a_184",wa="_infoSection_axu0a_201",Ta="_infoText_axu0a_208",t={container:Q,aiSummary:Z,mainBalance:aa,mainLabel:ea,mainValue:ta,statsRow:sa,statItem:na,statLabel:ra,statValue:ia,positive:oa,negative:la,statDivider:ca,performanceBar:da,performanceFill:ua,actionForm:ma,actionHeader:_a,actionTitle:ha,actionButtons:xa,maxButton:pa,historyList:ja,historyItem:fa,historyDate:va,historyBalance:ya,historyPnl:ga,infoSection:wa,infoText:Ta};function Aa(){const[e,x]=l.useState(null),[T,$]=l.useState([]),[P,N]=l.useState(!0),[E,S]=l.useState(!1),[B,D]=l.useState(null),[C,i]=l.useState(null),[o,_]=l.useState(null),[d,u]=l.useState(""),{showError:c,showSuccess:F}=V();l.useEffect(()=>{p()},[]);const p=async()=>{try{N(!0),D(null);const[n,s]=await Promise.all([W(),k(30)]);x(n),$(s.snapshots)}catch(n){const s=L(n);D(s),c(s)}finally{N(!1)}},M=async()=>{if(!o)return;if(i(null),!d||d.trim()===""){i("Please enter an amount"),c("Please enter an amount");return}const n=parseFloat(d);if(isNaN(n)||n<=0){i("Please enter a valid amount greater than 0"),c("Please enter a valid amount greater than 0");return}if(o==="deposit"){const s=parseFloat((e==null?void 0:e.wallet.usdt_balance)||"0");if(n>s){const r=`Insufficient wallet balance. You have $${s.toFixed(2)} USDT available.`;i(r),c(r);return}if(n<100){i("Minimum deposit is 100 USDT"),c("Minimum deposit is 100 USDT");return}}else{const s=parseFloat((e==null?void 0:e.ai_trader.current_balance_usdt)||"0");if(n>s){const r=`Insufficient AI Trader balance. You have $${s.toFixed(2)} USDT available.`;i(r),c(r);return}}try{if(S(!0),i(null),o==="deposit"){const s=await z(d);w("success"),x(r=>r&&{...r,wallet:s.wallet,ai_trader:s.ai_trader}),F(`Deposited $${parseFloat(s.amount_usdt).toFixed(2)} to AI Trader`)}else{const s=await Y(d);w("success"),x(r=>r&&{...r,wallet:s.wallet,ai_trader:s.ai_trader}),F(`Withdrew $${parseFloat(s.amount_usdt).toFixed(2)} to wallet`)}u(""),_(null)}catch(s){w("error");const r=L(s);i(r),c(r)}finally{S(!1)}},R=()=>{u(o==="deposit"?(e==null?void 0:e.wallet.usdt_balance)||"0":(e==null?void 0:e.ai_trader.current_balance_usdt)||"0")};if(P)return a.jsx(K,{message:"Loading AI Trader..."});if(B)return a.jsx(X,{message:B,onRetry:p});const m=n=>{const s=parseFloat(n);return isNaN(s)?"0.00":s.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})},j=parseFloat((e==null?void 0:e.ai_trader.realized_pnl_usdt)||"0")>=0,U=parseFloat((e==null?void 0:e.ai_trader.current_balance_usdt)||"0"),b=parseFloat((e==null?void 0:e.ai_trader.total_deposited_usdt)||"0");return a.jsx(q,{onRefresh:p,children:a.jsxs("div",{className:t.container,children:[(e==null?void 0:e.wallet)&&a.jsx(O,{usdtBalance:e.wallet.usdt_balance,ghdBalance:e.wallet.ghd_balance}),a.jsxs(f,{variant:"glow",children:[a.jsx(v,{children:a.jsxs(y,{children:[a.jsx(H,{size:20,color:"var(--brand-primary)"}),"AI Trader Account"]})}),a.jsx(g,{children:a.jsxs("div",{className:t.aiSummary,children:[a.jsxs("div",{className:t.mainBalance,children:[a.jsx("span",{className:t.mainLabel,children:"Current Balance"}),a.jsxs("span",{className:t.mainValue,children:["$",m((e==null?void 0:e.ai_trader.current_balance_usdt)||"0")]})]}),a.jsxs("div",{className:t.statsRow,children:[a.jsxs("div",{className:t.statItem,children:[a.jsx("span",{className:t.statLabel,children:"Total Deposited"}),a.jsxs("span",{className:t.statValue,children:["$",m((e==null?void 0:e.ai_trader.total_deposited_usdt)||"0")]})]}),a.jsx("div",{className:t.statDivider}),a.jsxs("div",{className:t.statItem,children:[a.jsx("span",{className:t.statLabel,children:"Total P&L"}),a.jsxs("span",{className:`${t.statValue} ${j?t.positive:t.negative}`,children:[j?"+":"","$",m((e==null?void 0:e.ai_trader.realized_pnl_usdt)||"0")]})]})]}),b>0&&a.jsx("div",{className:t.performanceBar,children:a.jsx("div",{className:`${t.performanceFill} ${j?t.positive:t.negative}`,style:{width:`${Math.min(100,Math.max(0,U/b*100))}%`}})})]})})]}),a.jsxs(f,{variant:"elevated",children:[a.jsx(v,{children:a.jsx(y,{children:"Transfer Funds"})}),a.jsx(g,{children:o?a.jsxs("div",{className:t.actionForm,children:[a.jsxs("div",{className:t.actionHeader,children:[o==="deposit"?a.jsx(A,{size:20,color:"var(--brand-primary)"}):a.jsx(I,{size:20,color:"var(--warning)"}),a.jsx("span",{className:t.actionTitle,children:o==="deposit"?"Deposit to AI Trader":"Withdraw to Wallet"})]}),a.jsx(J,{label:"Amount (USDT)",value:d,onChange:n=>{u(n),i(null)},placeholder:o==="deposit"?"Min: 100 USDT":"0.00",error:C||void 0,helperText:o==="deposit"?"Minimum deposit: 100 USDT":void 0,rightElement:a.jsx("button",{className:t.maxButton,onClick:R,children:"MAX"})}),a.jsxs("div",{className:t.actionButtons,children:[a.jsx(h,{variant:"secondary",onClick:()=>{_(null),u(""),i(null)},children:"Cancel"}),a.jsx(h,{loading:E,onClick:M,children:o==="deposit"?"Deposit":"Withdraw"})]})]}):a.jsxs("div",{className:t.actionButtons,children:[a.jsxs(h,{fullWidth:!0,onClick:()=>_("deposit"),children:[a.jsx(A,{size:18}),"Deposit"]}),a.jsxs(h,{fullWidth:!0,variant:"secondary",onClick:()=>_("withdraw"),children:[a.jsx(I,{size:18}),"Withdraw"]})]})})]}),a.jsxs(f,{children:[a.jsx(v,{children:a.jsx(y,{children:"Performance History"})}),a.jsx(g,{children:T.length===0?a.jsx(G,{icon:"ðŸ“Š",message:"No history yet. Start trading to see performance!"}):a.jsx("div",{className:t.historyList,children:T.slice(0,10).map(n=>{const r=parseFloat(n.pnl)>=0;return a.jsxs("div",{className:t.historyItem,children:[a.jsx("div",{className:t.historyDate,children:new Date(n.time).toLocaleDateString(void 0,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}),a.jsxs("div",{className:t.historyBalance,children:["$",m(n.balance)]}),a.jsxs("div",{className:`${t.historyPnl} ${r?t.positive:t.negative}`,children:[r?"+":"","$",m(n.pnl)]})]},n.id)})})})]}),a.jsx("div",{className:t.infoSection,children:a.jsx("p",{className:t.infoText,children:"ðŸ’¡ AI Trader uses advanced algorithms to trade crypto markets automatically. Deposit USDT and let AI work for you!"})})]})})}export{Aa as AITraderScreen};
