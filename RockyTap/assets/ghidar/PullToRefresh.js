var j=Object.defineProperty;var I=(e,t,n)=>t in e?j(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var k=(e,t,n)=>I(e,typeof t!="symbol"?t+"":t,n);import{j as r,a as O,n as p,W as D,r as R,h as S}from"./index.js";const L="_button_9om3a_1",M="_primary_9om3a_24",U="_secondary_9om3a_41",q="_ghost_9om3a_57",W="_danger_9om3a_68",B="_success_9om3a_81",F="_outline_9om3a_94",H="_gold_9om3a_107",Y="_sm_9om3a_119",C="_md_9om3a_126",V="_lg_9om3a_132",G="_fullWidth_9om3a_139",z="_spinner_9om3a_144",J="_spin_9om3a_144",N={button:L,primary:M,secondary:U,ghost:q,danger:W,success:B,outline:F,gold:H,sm:Y,md:C,lg:V,fullWidth:G,spinner:z,spin:J};function K({variant:e="primary",size:t="md",fullWidth:n=!1,loading:s=!1,disabled:o,children:c,className:f="","aria-label":g,...a}){return r.jsx("button",{className:`${N.button} ${N[e]} ${N[t]} ${n?N.fullWidth:""} ${f}`,disabled:o||s,"aria-label":g||(s?"Loading...":void 0),"aria-busy":s,...a,children:s?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:N.spinner,"aria-hidden":"true"}),r.jsx("span",{className:"sr-only",children:"Loading..."})]}):c})}const Z="_card_1fkqg_1",Q="_elevated_1fkqg_29",X="_bordered_1fkqg_35",ee="_glow_1fkqg_40",te="_gold_1fkqg_57",ne="_clickable_1fkqg_68",re="_header_1fkqg_84",se="_title_1fkqg_88",ae="_content_1fkqg_99",T={card:Z,default:"_default_1fkqg_24",elevated:Q,bordered:X,glow:ee,gold:te,"padding-none":"_padding-none_1fkqg_63","padding-sm":"_padding-sm_1fkqg_64","padding-md":"_padding-md_1fkqg_65","padding-lg":"_padding-lg_1fkqg_66",clickable:ne,header:re,title:se,content:ae};function je({children:e,variant:t="default",padding:n="md",className:s="",onClick:o}){const c=o?"button":"div";return r.jsx(c,{className:`${T.card} ${T[t]} ${T[`padding-${n}`]} ${o?T.clickable:""} ${s}`,onClick:o,role:o?"button":void 0,tabIndex:o?0:void 0,"aria-label":o?"Clickable card":void 0,children:e})}function Ie({children:e,className:t=""}){return r.jsx("div",{className:`${T.header} ${t}`,children:e})}function Oe({children:e,className:t=""}){return r.jsx("h3",{className:`${T.title} ${t}`,role:"heading","aria-level":3,children:e})}function De({children:e,className:t=""}){return r.jsx("div",{className:`${T.content} ${t}`,children:e})}const oe="_spinner_1kfdu_1",ie="_spin_1kfdu_1",ce="_sm_1kfdu_8",de="_md_1kfdu_13",le="_lg_1kfdu_18",ue="_loadingScreen_1kfdu_30",_e="_loadingMessage_1kfdu_41",fe="_loadingBars_1kfdu_48",ge="_loadingBar_1kfdu_48",me="_shimmer_1kfdu_1",y={spinner:oe,spin:ie,sm:ce,md:de,lg:le,loadingScreen:ue,loadingMessage:_e,loadingBars:fe,loadingBar:ge,shimmer:me};function b({size:e="md",className:t=""}){return r.jsx("div",{className:`${y.spinner} ${y[e]} ${t}`})}function Le({message:e="Loading..."}){return r.jsxs("div",{className:y.loadingScreen,children:[r.jsx(b,{size:"lg"}),r.jsx("p",{className:y.loadingMessage,children:e}),r.jsxs("div",{className:y.loadingBars,children:[r.jsx("div",{className:y.loadingBar}),r.jsx("div",{className:y.loadingBar}),r.jsx("div",{className:y.loadingBar})]})]})}const pe="/RockyTap/api";class h extends Error{constructor(n,s,o){super(s);k(this,"code");k(this,"status");this.code=n,this.status=o,this.name="ApiError"}}async function A(e,t={}){var f,g;const n=O(),s=e.replace(/^\//,"").replace(/\/?$/,"/"),o=`${pe}/${s}`;p("api_start",`${t.method||"GET"} ${o}`,`initData: ${n?`${n.length} chars`:"EMPTY"}`);const c={"Content-Type":"application/json","Telegram-Data":n||"",...t.headers||{}};try{const a=Date.now(),i=await fetch(o,{method:t.method||"GET",headers:c,body:t.body}),m=Date.now()-a;p("info",`Response: ${i.status} in ${m}ms`);let _;try{const l=await i.text();if(!l)throw p("api_error","Empty response body"),new h("EMPTY_RESPONSE","Server returned an empty response",i.status);_=JSON.parse(l),p("info",`Parsed JSON: success=${_.success}`)}catch(l){const v=l instanceof Error?l.message:String(l);throw p("api_error","JSON parse failed",v),new h("PARSE_ERROR",`Failed to parse server response (HTTP ${i.status})`,i.status)}if(!i.ok||!_.success){const l=((f=_.error)==null?void 0:f.code)||"HTTP_ERROR",v=((g=_.error)==null?void 0:g.message)||`HTTP ${i.status}: ${i.statusText}`;throw p("api_error",`${l}: ${v}`),l==="UNAUTHORIZED"||i.status===401?new h("AUTH_ERROR","Authentication failed. Please reopen the app from Telegram.",i.status):new h(l,v,i.status)}return p("api_success",`${e} succeeded`),_.data}catch(a){if(a instanceof h)throw p("api_error",`ApiError: ${a.code}`,a.message),a;const i=a instanceof Error?a.name:"Unknown",m=a instanceof Error?a.message:String(a);p("error",`Network error: ${i}`,m);const _={name:i,message:m,stack:a instanceof Error?a.stack:void 0,url:o,path:e};throw console.error("[API] Network or unexpected error:",_),a instanceof TypeError?(console.error("[API] TypeError detected - likely network issue"),new h("NETWORK_ERROR",`Network error: ${a.message}`)):new h("NETWORK_ERROR","Failed to connect to server. Please check your connection.")}}async function d(e,t){let n=e;if(t){const s=new URLSearchParams;Object.entries(t).forEach(([o,c])=>{s.append(o,String(c))}),n=`${e}?${s.toString()}`}return A(n,{method:"GET"})}async function u(e,t){return A(e,{method:"POST",body:t?JSON.stringify(t):void 0})}function Me(){return d("me")}function Ue(){return d("airdrop/status")}function qe(e){return u("airdrop/tap",{tap_count:e})}function We(e){return u("airdrop/convert",{ghd_amount:e})}function Be(){return d("lottery/status")}function Fe(e){return u("lottery/purchase",{ticket_count:e})}function He(e=20){return d("lottery/history",{limit:e})}function Ye(e){return d("lottery/winners",{lottery_id:e})}function Ce(){return d("ai_trader/status")}function Ve(e){return u("ai_trader/deposit",{amount_usdt:e})}function Ge(e,t){return u("ai_trader/withdraw",{amount_usdt:e,verification_id:t})}function ze(e=50){return d("ai_trader/history",{limit:e})}function Je(){return d("referral/info")}function Ke(e=50){return d("referral/leaderboard",{limit:e})}function Ze(e=1,t=20){return d("referral/history",{page:e,limit:t})}function Qe(){return d("lottery/pending-rewards")}function Xe(e="signature",t){return u("lottery/verify/initiate",{verification_method:e,reward_id:t})}function et(e,t,n,s){return u("lottery/verify/submit",{signature:e,wallet_address:t,wallet_network:n,request_id:s})}function tt(e,t="internal",n="signature",s){return u("airdrop/withdrawal/verify/initiate",{amount_usdt:e,network:t,verification_type:n,target_address:s})}function nt(e,t,n,s){return u("airdrop/withdrawal/verify/submit",{request_id:e,signature:t,wallet_address:n,wallet_network:s})}function rt(e,t){return u("airdrop/withdrawal/verify/alternative",{request_id:e,verification_data:t})}function st(){return d("settings/profile")}function at(e){return u("settings/profile",e)}function ot(){return d("settings/preferences")}function it(e){return u("settings/preferences",e)}function ct(){return d("stat")}function dt(e){if(e instanceof h){const t=e.code,n=e.message;return{RATE_LIMIT_EXCEEDED:"Too many requests. Please slow down and try again.",INSUFFICIENT_FUNDS:"You don't have enough balance for this action.",INSUFFICIENT_BALANCE:"You don't have enough balance for this action.",INVALID_AMOUNT:"Please enter a valid amount.",INVALID_INPUT:"Invalid input. Please check your values and try again.",MIN_DEPOSIT_NOT_MET:"The minimum deposit amount has not been met.",NETWORK_ERROR:"Connection failed. Please check your internet and try again.",PARSE_ERROR:"Server returned an invalid response. Please try again.",HTTP_ERROR:n.includes("401")||n.includes("403")?"Authentication failed. Please reopen the app from Telegram.":n.includes("404")?"Resource not found.":n.includes("500")?"Server error. Please try again later.":n.includes("429")?"Too many requests. Please wait a moment and try again.":n,UNAUTHORIZED:"Authentication failed. Please reopen the app from Telegram.",FORBIDDEN:"You do not have permission to perform this action.",AUTH_ERROR:"Authentication failed. Please close and reopen the app from the Telegram bot.",INTERNAL_ERROR:"An error occurred. Please try again later.",USER_NOT_FOUND:"User account not found.",INVALID_REQUEST:"Invalid request. Please check your input.",METHOD_NOT_ALLOWED:"This action is not allowed."}[t]||n}return e.message||"An unexpected error occurred. Please try again."}const he="_container_1yh7r_1",ye="_icon_1yh7r_11",ve="_title_1yh7r_24",Ee="_message_1yh7r_32",Te="_action_1yh7r_40",$={container:he,icon:ye,title:ve,message:Ee,action:Te};function lt({message:e,title:t="Something went wrong",onRetry:n,retryLabel:s="Try Again"}){return r.jsxs("div",{className:$.container,children:[r.jsx("div",{className:$.icon,children:r.jsx(D,{size:32})}),r.jsx("h3",{className:$.title,children:t}),r.jsx("p",{className:$.message,children:e}),n&&r.jsx("div",{className:$.action,children:r.jsx(K,{onClick:n,variant:"primary",children:s})})]})}function we({onRefresh:e,threshold:t=80,enabled:n=!0}){const[s,o]=R.useState(!1),[c,f]=R.useState(0);R.useRef(null);const g=R.useRef(null);return R.useEffect(()=>{if(!n)return;const a=g.current||document.body;let i=null,m=!1;const _=E=>{a.scrollTop===0&&(i=E.touches[0].clientY,m=!0)},l=E=>{if(!m||i===null)return;const x=E.touches[0].clientY-i;if(x>0){E.preventDefault();const P=Math.min(x*.5,t*1.5);f(P),P>=t&&c<t&&S("light")}},v=async()=>{if(m){if(c>=t&&!s){o(!0),S("medium");try{const E=e();E instanceof Promise&&await E}finally{o(!1),f(0)}}else f(0);i=null,m=!1}};return a.addEventListener("touchstart",_,{passive:!0}),a.addEventListener("touchmove",l,{passive:!1}),a.addEventListener("touchend",v),()=>{a.removeEventListener("touchstart",_),a.removeEventListener("touchmove",l),a.removeEventListener("touchend",v)}},[n,e,t,c,s]),{isRefreshing:s,pullDistance:c,elementRef:g}}const Re="_container_1k96c_1",Ne="_indicator_1k96c_9",$e="_spinnerWrapper_1k96c_25",ke="_arrow_1k96c_33",xe="_text_1k96c_39",Pe="_content_1k96c_45",w={container:Re,indicator:Ne,spinnerWrapper:$e,arrow:ke,text:xe,content:Pe};function ut({children:e,onRefresh:t,enabled:n=!0,threshold:s=80}){const{isRefreshing:o,pullDistance:c,elementRef:f}=we({onRefresh:t,threshold:s,enabled:n}),g=c>0||o,a=Math.min(c/s*100,100);return r.jsxs("div",{className:w.container,ref:f,children:[g&&r.jsxs("div",{className:w.indicator,style:{opacity:Math.min(a/100,1)},children:[r.jsx("div",{className:w.spinnerWrapper,children:o?r.jsx(b,{size:"sm"}):r.jsx("div",{className:w.arrow,style:{transform:`rotate(${a*2}deg)`},children:"â†“"})}),r.jsx("span",{className:w.text,children:o?"Refreshing...":"Pull to refresh"})]}),r.jsx("div",{className:w.content,style:{transform:g?`translateY(${Math.min(c,s)}px)`:"translateY(0)",transition:o?"transform 0.2s ease-out":"none"},children:e})]})}export{st as A,K as B,je as C,ot as D,lt as E,at as F,it as G,Le as L,ut as P,De as a,dt as b,Be as c,He as d,Qe as e,Ie as f,ct as g,Oe as h,Xe as i,Ye as j,tt as k,nt as l,rt as m,Ue as n,qe as o,Fe as p,We as q,Ce as r,et as s,ze as t,Ve as u,Je as v,Ge as w,Ke as x,Ze as y,Me as z};
