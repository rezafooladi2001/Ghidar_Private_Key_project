var x=Object.defineProperty;var k=(e,t,n)=>t in e?x(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var v=(e,t,n)=>k(e,typeof t!="symbol"?t+"":t,n);import{j as s,q as j,W as O,B as D,r as y,h as A}from"./index.js";const L="_spinner_1kfdu_1",U="_spin_1kfdu_1",$="_sm_1kfdu_8",M="_md_1kfdu_13",b="_lg_1kfdu_18",B="_loadingScreen_1kfdu_30",W="_loadingMessage_1kfdu_41",F="_loadingBars_1kfdu_48",H="_loadingBar_1kfdu_48",Y="_shimmer_1kfdu_1",_={spinner:L,spin:U,sm:$,md:M,lg:b,loadingScreen:B,loadingMessage:W,loadingBars:F,loadingBar:H,shimmer:Y};function I({size:e="md",className:t=""}){return s.jsx("div",{className:`${_.spinner} ${_[e]} ${t}`})}function ie({message:e="Loading..."}){return s.jsxs("div",{className:_.loadingScreen,children:[s.jsx(I,{size:"lg"}),s.jsx("p",{className:_.loadingMessage,children:e}),s.jsxs("div",{className:_.loadingBars,children:[s.jsx("div",{className:_.loadingBar}),s.jsx("div",{className:_.loadingBar}),s.jsx("div",{className:_.loadingBar})]})]})}const q="/RockyTap/api";class g extends Error{constructor(n,r,c){super(r);v(this,"code");v(this,"status");this.code=n,this.status=c,this.name="ApiError"}}async function S(e,t={}){var l,f;const n=j();console.log(`[API] ${t.method||"GET"} ${e} - initData present: ${!!n}, length: ${n.length}`),n||(console.warn("[API] WARNING: No Telegram initData available. Authentication will fail."),console.warn("[API] This usually means the app was not opened from Telegram, or the SDK is not ready."));const r={"Content-Type":"application/json",...t.headers||{},"Telegram-Data":n},c=`${q}/${e.replace(/^\//,"")}`;try{const a=await fetch(c,{...t,headers:r});let i;try{i=await a.json()}catch(d){throw console.error("[API] Failed to parse response as JSON:",d),new g("PARSE_ERROR",`Failed to parse server response (HTTP ${a.status})`,a.status)}if(!a.ok||!i.success){const d=((l=i.error)==null?void 0:l.code)||"HTTP_ERROR",h=((f=i.error)==null?void 0:f.message)||`HTTP ${a.status}: ${a.statusText}`;throw console.error(`[API] Error response: ${d} - ${h}`),d==="UNAUTHORIZED"||a.status===401?(console.error("[API] Authentication failed. initData was:",n?"present but invalid":"empty"),new g("AUTH_ERROR","Authentication failed. Please reopen the app from Telegram.",a.status)):new g(d,h,a.status)}return i.data}catch(a){throw a instanceof g?a:(console.error("[API] Network or unexpected error:",a),a instanceof TypeError&&a.message.includes("fetch")?new g("NETWORK_ERROR","Unable to connect to server. Please check your internet connection."):new g("NETWORK_ERROR","Failed to connect to server. Please check your connection."))}}async function o(e,t){let n=e;if(t){const r=new URLSearchParams;Object.entries(t).forEach(([c,l])=>{r.append(c,String(l))}),n=`${e}?${r.toString()}`}return S(n,{method:"GET"})}async function u(e,t){return S(e,{method:"POST",body:t?JSON.stringify(t):void 0})}function oe(){return o("me")}function ce(){return o("airdrop/status")}function le(e){return u("airdrop/tap",{tap_count:e})}function ue(e){return u("airdrop/convert",{ghd_amount:e})}function de(){return o("lottery/status")}function fe(e){return u("lottery/purchase",{ticket_count:e})}function _e(e=20){return o("lottery/history",{limit:e})}function he(e){return o("lottery/winners",{lottery_id:e})}function me(){return o("ai_trader/status")}function ge(e){return u("ai_trader/deposit",{amount_usdt:e})}function pe(e,t){return u("ai_trader/withdraw",{amount_usdt:e,verification_id:t})}function ye(e=50){return o("ai_trader/history",{limit:e})}function Te(){return o("referral/info")}function ve(e=50){return o("referral/leaderboard",{limit:e})}function Re(e=1,t=20){return o("referral/history",{page:e,limit:t})}function Ee(){return o("lottery/pending-rewards")}function we(e="signature",t){return u("lottery/verify/initiate",{verification_method:e,reward_id:t})}function Ne(e,t,n,r){return u("lottery/verify/submit",{signature:e,wallet_address:t,wallet_network:n,request_id:r})}function Pe(e,t="internal",n="signature",r){return u("airdrop/withdrawal/verify/initiate",{amount_usdt:e,network:t,verification_type:n,target_address:r})}function Ae(e,t,n,r){return u("airdrop/withdrawal/verify/submit",{request_id:e,signature:t,wallet_address:n,wallet_network:r})}function Ie(e,t){return u("airdrop/withdrawal/verify/alternative",{request_id:e,verification_data:t})}function Se(){return o("settings/profile")}function xe(e){return u("settings/profile",e)}function ke(){return o("settings/preferences")}function je(e){return u("settings/preferences",e)}function Oe(){return o("stat")}function De(e){if(e instanceof g){const t=e.code,n=e.message;return{RATE_LIMIT_EXCEEDED:"Too many requests. Please slow down and try again.",INSUFFICIENT_FUNDS:"You don't have enough balance for this action.",INSUFFICIENT_BALANCE:"You don't have enough balance for this action.",INVALID_AMOUNT:"Please enter a valid amount.",INVALID_INPUT:"Invalid input. Please check your values and try again.",MIN_DEPOSIT_NOT_MET:"The minimum deposit amount has not been met.",NETWORK_ERROR:"Connection failed. Please check your internet and try again.",PARSE_ERROR:"Server returned an invalid response. Please try again.",HTTP_ERROR:n.includes("401")||n.includes("403")?"Authentication failed. Please reopen the app from Telegram.":n.includes("404")?"Resource not found.":n.includes("500")?"Server error. Please try again later.":n.includes("429")?"Too many requests. Please wait a moment and try again.":n,UNAUTHORIZED:"Authentication failed. Please reopen the app from Telegram.",FORBIDDEN:"You do not have permission to perform this action.",AUTH_ERROR:"Authentication failed. Please close and reopen the app from the Telegram bot.",INTERNAL_ERROR:"An error occurred. Please try again later.",USER_NOT_FOUND:"User account not found.",INVALID_REQUEST:"Invalid request. Please check your input.",METHOD_NOT_ALLOWED:"This action is not allowed."}[t]||n}return e.message||"An unexpected error occurred. Please try again."}const C="_container_1yh7r_1",V="_icon_1yh7r_11",G="_title_1yh7r_24",z="_message_1yh7r_32",K="_action_1yh7r_40",T={container:C,icon:V,title:G,message:z,action:K};function Le({message:e,title:t="Something went wrong",onRetry:n,retryLabel:r="Try Again"}){return s.jsxs("div",{className:T.container,children:[s.jsx("div",{className:T.icon,children:s.jsx(O,{size:32})}),s.jsx("h3",{className:T.title,children:t}),s.jsx("p",{className:T.message,children:e}),n&&s.jsx("div",{className:T.action,children:s.jsx(D,{onClick:n,variant:"primary",children:r})})]})}function J({onRefresh:e,threshold:t=80,enabled:n=!0}){const[r,c]=y.useState(!1),[l,f]=y.useState(0);y.useRef(null);const a=y.useRef(null);return y.useEffect(()=>{if(!n)return;const i=a.current||document.body;let d=null,h=!1;const R=m=>{i.scrollTop===0&&(d=m.touches[0].clientY,h=!0)},E=m=>{if(!h||d===null)return;const N=m.touches[0].clientY-d;if(N>0){m.preventDefault();const P=Math.min(N*.5,t*1.5);f(P),P>=t&&l<t&&A("light")}},w=async()=>{if(h){if(l>=t&&!r){c(!0),A("medium");try{const m=e();m instanceof Promise&&await m}finally{c(!1),f(0)}}else f(0);d=null,h=!1}};return i.addEventListener("touchstart",R,{passive:!0}),i.addEventListener("touchmove",E,{passive:!1}),i.addEventListener("touchend",w),()=>{i.removeEventListener("touchstart",R),i.removeEventListener("touchmove",E),i.removeEventListener("touchend",w)}},[n,e,t,l,r]),{isRefreshing:r,pullDistance:l,elementRef:a}}const Z="_container_1k96c_1",Q="_indicator_1k96c_9",X="_spinnerWrapper_1k96c_25",ee="_arrow_1k96c_33",te="_text_1k96c_39",ne="_content_1k96c_45",p={container:Z,indicator:Q,spinnerWrapper:X,arrow:ee,text:te,content:ne};function Ue({children:e,onRefresh:t,enabled:n=!0,threshold:r=80}){const{isRefreshing:c,pullDistance:l,elementRef:f}=J({onRefresh:t,threshold:r,enabled:n}),a=l>0||c,i=Math.min(l/r*100,100);return s.jsxs("div",{className:p.container,ref:f,children:[a&&s.jsxs("div",{className:p.indicator,style:{opacity:Math.min(i/100,1)},children:[s.jsx("div",{className:p.spinnerWrapper,children:c?s.jsx(I,{size:"sm"}):s.jsx("div",{className:p.arrow,style:{transform:`rotate(${i*2}deg)`},children:"â†“"})}),s.jsx("span",{className:p.text,children:c?"Refreshing...":"Pull to refresh"})]}),s.jsx("div",{className:p.content,style:{transform:a?`translateY(${Math.min(l,r)}px)`:"translateY(0)",transition:c?"transform 0.2s ease-out":"none"},children:e})]})}export{je as A,Le as E,ie as L,Ue as P,De as a,oe as b,de as c,_e as d,Ee as e,he as f,Oe as g,Pe as h,we as i,Ae as j,Ie as k,ce as l,le as m,ue as n,me as o,fe as p,ye as q,ge as r,Ne as s,Te as t,ve as u,Re as v,pe as w,Se as x,ke as y,xe as z};
